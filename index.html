<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>GlossÃ¡rio Trade â€¢ Pulse Kmais</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0054A6" />

  <!-- iOS / Apple -->
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Pulse Kmais" />

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png" />

  <!-- CSS -->
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <header class="app-header">
    <div class="app-brand">
      <div class="app-logo">P</div>
      <div class="app-title-group">
        <h1>GlossÃ¡rio Trade</h1>
        <p>Pulse Kmais</p>
      </div>
    </div>
  </header>

  <main class="app-main">

    <section class="card">
      <h2>Buscar termo</h2>
      <input
        type="search"
        id="globalSearch"
        placeholder="Digite um termo (ex.: share, ruptura, shopper, planograma)..."
        autocomplete="off"
      />
      <p class="hint">Pressione Enter para abrir o glossÃ¡rio jÃ¡ filtrado.</p>

      <div class="search-actions">
        <a href="glossario.html" class="btn">ðŸ“˜ Acessar GlossÃ¡rio</a>
        <a href="materiais.html" class="btn btn-outline">ðŸ›’ Materiais de PDV</a>
      </div>
    </section>

    <section class="card">
      <h2>ðŸ§® Calculadora de Share de GÃ´ndola</h2>
      <div class="row">
        <input type="number" id="totalFrentes" inputmode="numeric" min="0" step="1" placeholder="NÂº de frentes totais" />
        <input type="number" id="frentesMarca" inputmode="numeric" min="0" step="1" placeholder="NÂº de frentes da marca" />
      </div>

      <div style="margin-top:10px" class="kpi" aria-live="polite">
        <span>Resultado</span>
        <strong id="shareOut">â€”</strong>
        <span id="shareHint" class="hint" style="margin:0"></span>
      </div>

      <div class="search-actions">
        <button class="btn" id="btnCalcular">Calcular</button>
        <button class="btn btn-outline" id="btnLimpar">Limpar</button>
      </div>

      <p class="hint">FÃ³rmula: (frentes da marca Ã· frentes totais) Ã— 100</p>
    </section>

    <section class="card">
      <h2>Cliente atendido</h2>
      <p class="hint">Selecione para registrar o contexto do promotor (salvo neste aparelho).</p>

      <div class="search-actions" role="group" aria-label="Selecionar cliente">
        <button class="btn-pill" data-cliente="Vigor">Vigor</button>
        <button class="btn-pill" data-cliente="Cliente 2">Cliente 2</button>
        <button class="btn-pill" data-cliente="Cliente 3">Cliente 3</button>
      </div>

      <p class="hint" id="clienteAtivo">Cliente ativo: â€”</p>
    </section>

    <section class="card">
      <h2>NavegaÃ§Ã£o rÃ¡pida</h2>
      <div class="home-links">
        <a href="glossario.html" class="home-link">
          <h3>ðŸ“˜ GlossÃ¡rio</h3>
          <p>Termos, expressÃµes e indicadores usados no dia a dia.</p>
        </a>
        <a href="materiais.html" class="home-link">
          <h3>ðŸ›’ Materiais de PDV</h3>
          <p>PeÃ§as fÃ­sicas de loja, funÃ§Ãµes e exemplos prÃ¡ticos.</p>
        </a>
      </div>
    </section>

  </main>

  <footer class="app-footer">
    <p>Pulse Kmais â€¢ Base oficial de termos do PDV, Trade e ExecuÃ§Ã£o</p>
  </footer>

  <script>
    // -------- Busca global: Enter -> glossÃ¡rio com ?q= --------
    const globalInput = document.getElementById('globalSearch');
    globalInput?.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const value = encodeURIComponent(globalInput.value.trim());
        if (!value) return;
        window.location.href = 'glossario.html?q=' + value;
      }
    });

    // -------- Calculadora de share --------
    const totalEl = document.getElementById('totalFrentes');
    const marcaEl = document.getElementById('frentesMarca');
    const outEl = document.getElementById('shareOut');
    const hintEl = document.getElementById('shareHint');

    function calcShare() {
      const total = Number(totalEl.value);
      const marca = Number(marcaEl.value);
      hintEl.textContent = '';

      if (!total && !marca) {
        outEl.textContent = 'â€”';
        return;
      }
      if (total <= 0) {
        outEl.textContent = 'â€”';
        hintEl.textContent = 'Informe um total maior que zero.';
        return;
      }
      if (marca < 0 || marca > total) {
        outEl.textContent = 'â€”';
        hintEl.textContent = 'A marca deve ser entre 0 e o total.';
        return;
      }

      const share = (marca / total) * 100;
      outEl.textContent = share.toFixed(1) + '%';
    }

    document.getElementById('btnCalcular')?.addEventListener('click', calcShare);
    document.getElementById('btnLimpar')?.addEventListener('click', () => {
      totalEl.value = '';
      marcaEl.value = '';
      outEl.textContent = 'â€”';
      hintEl.textContent = '';
    });

    // Auto-cÃ¡lculo enquanto digita (leve)
    totalEl?.addEventListener('input', calcShare);
    marcaEl?.addEventListener('input', calcShare);

    // -------- Seletor de clientes (3 botÃµes) --------
    const pills = Array.from(document.querySelectorAll('.btn-pill'));
    const clienteAtivoEl = document.getElementById('clienteAtivo');
    const KEY = 'pulse_cliente_ativo';

    function renderCliente() {
      const current = localStorage.getItem(KEY) || '';
      clienteAtivoEl.textContent = 'Cliente ativo: ' + (current || 'â€”');
      pills.forEach(btn => {
        const isActive = btn.getAttribute('data-cliente') === current;
        btn.classList.toggle('active', isActive);
      });
    }

    pills.forEach(btn => {
      btn.addEventListener('click', () => {
        const c = btn.getAttribute('data-cliente');
        localStorage.setItem(KEY, c);
        renderCliente();

        // Redireciona para o glossÃ¡rio do cliente
        if (c === 'Vigor') {
          window.location.href = 'glossario_vigor.html';
        } else if (c === 'Cliente 2') {
          window.location.href = 'glossario_cliente2.html';
        } else if (c === 'Cliente 3') {
          window.location.href = 'glossario_cliente3.html';
        }
      });
    });

    renderCliente();

    // -------- Service Worker --------
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').catch(console.error);
    }
  </script>
</body>
</html>
